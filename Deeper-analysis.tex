% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Deeper analysis and Network statistics},
  pdfauthor={Jinxi\_Hu-48528608, Samarth\_Grover-38220463},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Deeper analysis and Network statistics}
\author{Jinxi\_Hu-48528608, Samarth\_Grover-38220463}
\date{2025-11-09}

\begin{document}
\maketitle

\subsection{set up}\label{set-up}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readr)}
\FunctionTok{library}\NormalTok{(igraph)}
\FunctionTok{library}\NormalTok{(RColorBrewer)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(reshape2)}
\FunctionTok{library}\NormalTok{(scales)}
\FunctionTok{library}\NormalTok{(gridExtra)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{48528608}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Load and prepare connected nodes data (Jinxi
Hu)}\label{load-and-prepare-connected-nodes-data-jinxi-hu}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the connected nodes and edges data}
\NormalTok{nodes\_connected }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/nodes\_connected.csv"}\NormalTok{)}
\NormalTok{edges\_connected }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/edges\_connected.csv"}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"=== DATA LOADING ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === DATA LOADING ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Connected nodes loaded:"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(nodes\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Connected nodes loaded: 1582
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Connected edges loaded:"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(edges\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Connected edges loaded: 3757
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create the graph from connected nodes only}
\NormalTok{graph\_connected }\OtherTok{\textless{}{-}} \FunctionTok{graph\_from\_data\_frame}\NormalTok{(edges\_connected, }
                                        \AttributeTok{vertices =}\NormalTok{ nodes\_connected, }
                                        \AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\# Remove multiple edges and self{-}loops for cleaner analysis}
\NormalTok{graph\_connected }\OtherTok{\textless{}{-}} \FunctionTok{simplify}\NormalTok{(graph\_connected, }
                          \AttributeTok{remove.multiple =} \ConstantTok{TRUE}\NormalTok{, }
                          \AttributeTok{remove.loops =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Graph created successfully}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Graph created successfully
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Final nodes in graph:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Final nodes in graph: 1582
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Final edges in graph:"}\NormalTok{, }\FunctionTok{ecount}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Final edges in graph: 3730
\end{verbatim}

\subsection{Basic Graph Analysis (Jinxi
Hu)}\label{basic-graph-analysis-jinxi-hu}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== BASIC GRAPH STATISTICS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === BASIC GRAPH STATISTICS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Total nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total nodes: 1582
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Total edges (citations):"}\NormalTok{, }\FunctionTok{ecount}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total edges (citations): 3730
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Network density:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{edge\_density}\NormalTok{(graph\_connected), }\DecValTok{6}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Network density: 0.001491
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Is directed:"}\NormalTok{, }\FunctionTok{is\_directed}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Is directed: TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Is weighted:"}\NormalTok{, }\FunctionTok{is\_weighted}\NormalTok{(graph\_connected), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Is weighted: FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate degree statistics}
\NormalTok{all\_degrees }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(graph\_connected, }\AttributeTok{mode =} \StringTok{"all"}\NormalTok{)}
\NormalTok{in\_degrees }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(graph\_connected, }\AttributeTok{mode =} \StringTok{"in"}\NormalTok{)}
\NormalTok{out\_degrees }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(graph\_connected, }\AttributeTok{mode =} \StringTok{"out"}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"=== DEGREE STATISTICS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === DEGREE STATISTICS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average total degree:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(all\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average total degree: 4.72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average in{-}degree (citations received):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(in\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average in-degree (citations received): 2.36
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average out{-}degree (citations made):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(out\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average out-degree (citations made): 2.36
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Degree range (total):"}\NormalTok{, }\FunctionTok{min}\NormalTok{(all\_degrees), }\StringTok{"{-}"}\NormalTok{, }\FunctionTok{max}\NormalTok{(all\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Degree range (total): 0 - 110
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Degree range (in):"}\NormalTok{, }\FunctionTok{min}\NormalTok{(in\_degrees), }\StringTok{"{-}"}\NormalTok{, }\FunctionTok{max}\NormalTok{(in\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Degree range (in): 0 - 104
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Degree range (out):"}\NormalTok{, }\FunctionTok{min}\NormalTok{(out\_degrees), }\StringTok{"{-}"}\NormalTok{, }\FunctionTok{max}\NormalTok{(out\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Degree range (out): 0 - 29
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Standard deviation (total):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{sd}\NormalTok{(all\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Standard deviation (total): 6.74
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Standard deviation (in):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{sd}\NormalTok{(in\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Standard deviation (in): 6.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Standard deviation (out):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{sd}\NormalTok{(out\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Standard deviation (out): 2.72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== COMPONENT ANALYSIS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === COMPONENT ANALYSIS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Analyze weakly connected components}
\NormalTok{weak\_components }\OtherTok{\textless{}{-}} \FunctionTok{components}\NormalTok{(graph\_connected, }\AttributeTok{mode =} \StringTok{"weak"}\NormalTok{)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of weakly connected components:"}\NormalTok{, weak\_components}\SpecialCharTok{$}\NormalTok{no, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of weakly connected components: 58
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Size of largest weak component:"}\NormalTok{, }\FunctionTok{max}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Size of largest weak component: 1433
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Proportion of nodes in largest weak component:"}\NormalTok{, }
    \FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize) }\SpecialCharTok{/} \FunctionTok{vcount}\NormalTok{(graph\_connected) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{2}\NormalTok{), }\StringTok{"\%}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Proportion of nodes in largest weak component: 90.58 %
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Analyze strongly connected components}
\NormalTok{strong\_components }\OtherTok{\textless{}{-}} \FunctionTok{components}\NormalTok{(graph\_connected, }\AttributeTok{mode =} \StringTok{"strong"}\NormalTok{)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of strongly connected components:"}\NormalTok{, strong\_components}\SpecialCharTok{$}\NormalTok{no, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of strongly connected components: 1569
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Size of largest strong component:"}\NormalTok{, }\FunctionTok{max}\NormalTok{(strong\_components}\SpecialCharTok{$}\NormalTok{csize), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Size of largest strong component: 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Proportion of nodes in largest strong component:"}\NormalTok{, }
    \FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(strong\_components}\SpecialCharTok{$}\NormalTok{csize) }\SpecialCharTok{/} \FunctionTok{vcount}\NormalTok{(graph\_connected) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{2}\NormalTok{), }\StringTok{"\%}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Proportion of nodes in largest strong component: 0.38 %
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Component size distribution}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Weak component sizes (top 10):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Weak component sizes (top 10):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weak\_sizes }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{head}\NormalTok{(weak\_sizes, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1433   27    9    5    5    4    3    3    3    3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Strong component sizes (top 10):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Strong component sizes (top 10):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strong\_sizes }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(strong\_components}\SpecialCharTok{$}\NormalTok{csize, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{head}\NormalTok{(strong\_sizes, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 6 2 2 2 2 2 2 2 2 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create comprehensive degree distribution analysis}

\CommentTok{\# Prepare data for plotting}
\NormalTok{degree\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{node\_id =} \FunctionTok{V}\NormalTok{(graph\_connected)}\SpecialCharTok{$}\NormalTok{name,}
  \AttributeTok{total\_degree =}\NormalTok{ all\_degrees,}
  \AttributeTok{in\_degree =}\NormalTok{ in\_degrees,}
  \AttributeTok{out\_degree =}\NormalTok{ out\_degrees}
\NormalTok{)}

\CommentTok{\# Add node attributes for additional analysis}
\NormalTok{degree\_data}\SpecialCharTok{$}\NormalTok{institution }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(graph\_connected)}\SpecialCharTok{$}\NormalTok{institution}
\NormalTok{degree\_data}\SpecialCharTok{$}\NormalTok{subtopic }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(graph\_connected)}\SpecialCharTok{$}\NormalTok{subtopic}
\NormalTok{degree\_data}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(graph\_connected)}\SpecialCharTok{$}\NormalTok{year}
\NormalTok{degree\_data}\SpecialCharTok{$}\NormalTok{citations }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(graph\_connected)}\SpecialCharTok{$}\NormalTok{citations}

\FunctionTok{cat}\NormalTok{(}\StringTok{"=== DEGREE DISTRIBUTION SUMMARY ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === DEGREE DISTRIBUTION SUMMARY ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Total degree quartiles:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Total degree quartiles:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{quantile}\NormalTok{(all\_degrees))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   0%  25%  50%  75% 100% 
##    0    1    3    5  110
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{In{-}degree quartiles:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## In-degree quartiles:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{quantile}\NormalTok{(in\_degrees))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   0%  25%  50%  75% 100% 
##    0    0    1    2  104
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Out{-}degree quartiles:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Out-degree quartiles:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{quantile}\NormalTok{(out\_degrees))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   0%  25%  50%  75% 100% 
##    0    1    2    3   29
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# In{-}degree distribution histogram}
\FunctionTok{ggplot}\NormalTok{(degree\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ in\_degree)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{, }\AttributeTok{fill =} \StringTok{"lightblue"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"In{-}Degree Distribution (Citations Received)"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Connected nodes (n ="}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(graph\_connected), }\StringTok{")"}\NormalTok{),}
       \AttributeTok{x =} \StringTok{"In{-}Degree (Citations Received)"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{max}\NormalTok{(in\_degrees), }\AttributeTok{by =} \DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/in-degree-histogram-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print summary statistics}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{IN{-}DEGREE DISTRIBUTION STATISTICS:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## IN-DEGREE DISTRIBUTION STATISTICS:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mean:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(in\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mean: 2.36
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Median:"}\NormalTok{, }\FunctionTok{median}\NormalTok{(in\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Median: 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mode:"}\NormalTok{, }\FunctionTok{names}\NormalTok{(}\FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(in\_degrees), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))[}\DecValTok{1}\NormalTok{], }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mode: 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with 0 in{-}degree:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(in\_degrees }\SpecialCharTok{==} \DecValTok{0}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with 0 in-degree: 776
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with \textgreater{}10 in{-}degree:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(in\_degrees }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with >10 in-degree: 80
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Out{-}degree distribution histogram}
\FunctionTok{ggplot}\NormalTok{(degree\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ out\_degree)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{, }\AttributeTok{fill =} \StringTok{"lightcoral"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Out{-}Degree Distribution (Citations Made)"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Connected nodes (n ="}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(graph\_connected), }\StringTok{")"}\NormalTok{),}
       \AttributeTok{x =} \StringTok{"Out{-}Degree (Citations Made)"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{max}\NormalTok{(out\_degrees), }\AttributeTok{by =} \DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/out-degree-histogram-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print summary statistics}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{OUT{-}DEGREE DISTRIBUTION STATISTICS:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## OUT-DEGREE DISTRIBUTION STATISTICS:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mean:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(out\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mean: 2.36
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Median:"}\NormalTok{, }\FunctionTok{median}\NormalTok{(out\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Median: 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mode:"}\NormalTok{, }\FunctionTok{names}\NormalTok{(}\FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(out\_degrees), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))[}\DecValTok{1}\NormalTok{], }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mode: 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with 0 out{-}degree:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(out\_degrees }\SpecialCharTok{==} \DecValTok{0}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with 0 out-degree: 290
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with \textgreater{}10 out{-}degree:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(out\_degrees }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with >10 out-degree: 26
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Total degree distribution histogram}
\FunctionTok{ggplot}\NormalTok{(degree\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ total\_degree)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{2}\NormalTok{, }\AttributeTok{fill =} \StringTok{"lightgreen"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Total Degree Distribution"}\NormalTok{,}
       \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Connected nodes (n ="}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(graph\_connected), }\StringTok{")"}\NormalTok{),}
       \AttributeTok{x =} \StringTok{"Total Degree (In + Out)"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{max}\NormalTok{(all\_degrees), }\AttributeTok{by =} \DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/total-degree-histogram-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print summary statistics}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{TOTAL DEGREE DISTRIBUTION STATISTICS:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## TOTAL DEGREE DISTRIBUTION STATISTICS:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mean:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(all\_degrees), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mean: 4.72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Median:"}\NormalTok{, }\FunctionTok{median}\NormalTok{(all\_degrees), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Median: 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Mode:"}\NormalTok{, }\FunctionTok{names}\NormalTok{(}\FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(all\_degrees), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))[}\DecValTok{1}\NormalTok{], }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mode: 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with degree 1:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(all\_degrees }\SpecialCharTok{==} \DecValTok{1}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with degree 1: 434
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes with degree \textgreater{}20:"}\NormalTok{, }\FunctionTok{sum}\NormalTok{(all\_degrees }\SpecialCharTok{\textgreater{}} \DecValTok{20}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes with degree >20: 43
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create combined degree distribution plot}
\NormalTok{degree\_long }\OtherTok{\textless{}{-}}\NormalTok{ reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(degree\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"in\_degree"}\NormalTok{, }\StringTok{"out\_degree"}\NormalTok{, }\StringTok{"total\_degree"}\NormalTok{)],}
                             \AttributeTok{variable.name =} \StringTok{"degree\_type"}\NormalTok{,}
                             \AttributeTok{value.name =} \StringTok{"degree\_value"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## No id variables; using all as measure variables
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Rename for better labels}
\NormalTok{degree\_long}\SpecialCharTok{$}\NormalTok{degree\_type }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(degree\_long}\SpecialCharTok{$}\NormalTok{degree\_type,}
                                 \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"in\_degree"}\NormalTok{, }\StringTok{"out\_degree"}\NormalTok{, }\StringTok{"total\_degree"}\NormalTok{),}
                                 \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"In{-}Degree"}\NormalTok{, }\StringTok{"Out{-}Degree"}\NormalTok{, }\StringTok{"Total Degree"}\NormalTok{))}

\CommentTok{\# Create faceted histogram}
\FunctionTok{ggplot}\NormalTok{(degree\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ degree\_value, }\AttributeTok{fill =}\NormalTok{ degree\_type)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{bins =} \DecValTok{30}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{degree\_type, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"In{-}Degree"} \OtherTok{=} \StringTok{"lightblue"}\NormalTok{, }
                              \StringTok{"Out{-}Degree"} \OtherTok{=} \StringTok{"lightcoral"}\NormalTok{, }
                              \StringTok{"Total Degree"} \OtherTok{=} \StringTok{"lightgreen"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Degree Distribution Comparison"}\NormalTok{,}
       \AttributeTok{subtitle =} \StringTok{"In{-}Degree vs Out{-}Degree vs Total Degree"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Degree Value"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
        \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/degree-comparison-plot-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Analyze the largest component in detail}
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== LARGEST COMPONENT DETAILED ANALYSIS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === LARGEST COMPONENT DETAILED ANALYSIS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract the largest weakly connected component}
\NormalTok{largest\_comp\_nodes }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{membership }\SpecialCharTok{==} \FunctionTok{which.max}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize))}
\NormalTok{largest\_component }\OtherTok{\textless{}{-}} \FunctionTok{induced\_subgraph}\NormalTok{(graph\_connected, largest\_comp\_nodes)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Largest component statistics:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Largest component statistics:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nodes: 1433
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Edges:"}\NormalTok{, }\FunctionTok{ecount}\NormalTok{(largest\_component), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Edges: 3634
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Density:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{edge\_density}\NormalTok{(largest\_component), }\DecValTok{6}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Density: 0.001771
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average in degree:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(}\FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"in"}\NormalTok{)), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average in degree: 2.54
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average out degree:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(}\FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"out"}\NormalTok{)), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average out degree: 2.54
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average degree:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(}\FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"all"}\NormalTok{)), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average degree: 5.07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Diameter:"}\NormalTok{, }\FunctionTok{diameter}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{FALSE}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Diameter: 13
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Average path length:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean\_distance}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{FALSE}\NormalTok{), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Average path length: 4.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check if there are smaller components worth analyzing}
\ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize)) }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{) \{}
\NormalTok{  second\_largest\_size }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{2}\NormalTok{]}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Second largest component size:"}\NormalTok{, second\_largest\_size, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Ratio (largest/second largest):"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(weak\_components}\SpecialCharTok{$}\NormalTok{csize) }\SpecialCharTok{/} 
\NormalTok{  second\_largest\_size, }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Second largest component size: 27 
## Ratio (largest/second largest): 53.07
\end{verbatim}

\subsection{Advanced Analysis of Largest Component (Jinxi
Hu)}\label{advanced-analysis-of-largest-component-jinxi-hu}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== CENTRALITY ANALYSIS OF LARGEST COMPONENT ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === CENTRALITY ANALYSIS OF LARGEST COMPONENT ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate various centrality measures}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Calculating centrality measures...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Calculating centrality measures...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Degree centrality (already calculated above)}
\NormalTok{degree\_cent\_in }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"in"}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{degree\_cent\_out }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"out"}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{degree\_cent\_all }\OtherTok{\textless{}{-}} \FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"all"}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Betweenness centrality}
\NormalTok{betweenness\_cent }\OtherTok{\textless{}{-}} \FunctionTok{betweenness}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Closeness centrality}
\NormalTok{closeness\_cent\_in }\OtherTok{\textless{}{-}} \FunctionTok{closeness}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"in"}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{closeness\_cent\_out }\OtherTok{\textless{}{-}} \FunctionTok{closeness}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"out"}\NormalTok{, }\AttributeTok{normalized =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Eigenvector centrality}
\NormalTok{eigenvector\_cent }\OtherTok{\textless{}{-}} \FunctionTok{eigen\_centrality}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{scale =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{vector}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The `scale` argument of `eigen_centrality()` is deprecated as of igraph 2.1.1.
## i eigen_centrality() will always behave as if scale=TRUE were used.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# PageRank centrality}
\NormalTok{pagerank\_cent }\OtherTok{\textless{}{-}} \FunctionTok{page\_rank}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{vector}

\CommentTok{\# Authority and Hub scores (HITS algorithm)}
\NormalTok{hits\_scores }\OtherTok{\textless{}{-}} \FunctionTok{hub\_score}\NormalTok{(largest\_component)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `hub_score()` was deprecated in igraph 2.0.3.
## i Please use `hits_scores()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hub\_cent }\OtherTok{\textless{}{-}}\NormalTok{ hits\_scores}\SpecialCharTok{$}\NormalTok{vector}
\NormalTok{authority\_cent }\OtherTok{\textless{}{-}} \FunctionTok{authority\_score}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{vector}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `authority_score()` was deprecated in igraph 2.1.0.
## i Please use `hits_scores()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"All centrality measures calculated successfully!}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## All centrality measures calculated successfully!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create centrality summary}
\NormalTok{centrality\_summary }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{node\_id =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name,}
  \AttributeTok{degree\_in =}\NormalTok{ degree\_cent\_in,}
  \AttributeTok{degree\_out =}\NormalTok{ degree\_cent\_out,}
  \AttributeTok{degree\_all =}\NormalTok{ degree\_cent\_all,}
  \AttributeTok{betweenness =}\NormalTok{ betweenness\_cent,}
  \AttributeTok{closeness\_in =}\NormalTok{ closeness\_cent\_in,}
  \AttributeTok{closeness\_out =}\NormalTok{ closeness\_cent\_out,}
  \AttributeTok{eigenvector =}\NormalTok{ eigenvector\_cent,}
  \AttributeTok{pagerank =}\NormalTok{ pagerank\_cent,}
  \AttributeTok{hub =}\NormalTok{ hub\_cent,}
  \AttributeTok{authority =}\NormalTok{ authority\_cent}
\NormalTok{)}
\CommentTok{\# Print top nodes by different centrality measures}
\FunctionTok{cat}\NormalTok{(}\StringTok{"TOP 5 NODES BY DIFFERENT CENTRALITY MEASURES:}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## TOP 5 NODES BY DIFFERENT CENTRALITY MEASURES:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Highest In{-}Degree Centrality (most cited):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Highest In-Degree Centrality (most cited):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_in\_degree }\OtherTok{\textless{}{-}}\NormalTok{ centrality\_summary[}\FunctionTok{order}\NormalTok{(centrality\_summary}\SpecialCharTok{$}\NormalTok{degree\_in, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }
                                   \FunctionTok{c}\NormalTok{(}\StringTok{"node\_id"}\NormalTok{, }\StringTok{"degree\_in"}\NormalTok{)]}
\FunctionTok{print}\NormalTok{(top\_in\_degree)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id  degree_in
## P0060   P0060 0.07262570
## P0001   P0001 0.04399441
## P0009   P0009 0.04399441
## P0002   P0002 0.04259777
## P0199   P0199 0.04259777
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Highest PageRank (most influential):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Highest PageRank (most influential):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_pagerank }\OtherTok{\textless{}{-}}\NormalTok{ centrality\_summary[}\FunctionTok{order}\NormalTok{(centrality\_summary}\SpecialCharTok{$}\NormalTok{pagerank, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }
                                  \FunctionTok{c}\NormalTok{(}\StringTok{"node\_id"}\NormalTok{, }\StringTok{"pagerank"}\NormalTok{)]}
\FunctionTok{print}\NormalTok{(top\_pagerank)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id   pagerank
## P0199   P0199 0.04046559
## P0031   P0031 0.03232105
## P0741   P0741 0.01974340
## P0116   P0116 0.01746391
## P0535   P0535 0.01572970
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Highest Betweenness Centrality (most important bridges):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Highest Betweenness Centrality (most important bridges):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_betweenness }\OtherTok{\textless{}{-}}\NormalTok{ centrality\_summary[}\FunctionTok{order}\NormalTok{(centrality\_summary}\SpecialCharTok{$}\NormalTok{betweenness, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }
                                     \FunctionTok{c}\NormalTok{(}\StringTok{"node\_id"}\NormalTok{, }\StringTok{"betweenness"}\NormalTok{)]}
\FunctionTok{print}\NormalTok{(top\_betweenness)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id betweenness
## P0011   P0011 0.002580361
## P0060   P0060 0.002094395
## P0003   P0003 0.001932865
## P0002   P0002 0.001732924
## P0001   P0001 0.001339179
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Highest Authority Score (most authoritative):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Highest Authority Score (most authoritative):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_authority }\OtherTok{\textless{}{-}}\NormalTok{ centrality\_summary[}\FunctionTok{order}\NormalTok{(centrality\_summary}\SpecialCharTok{$}\NormalTok{authority, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }
                                   \FunctionTok{c}\NormalTok{(}\StringTok{"node\_id"}\NormalTok{, }\StringTok{"authority"}\NormalTok{)]}
\FunctionTok{print}\NormalTok{(top\_authority)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id authority
## P0009   P0009 1.0000000
## P0060   P0060 0.9173024
## P0017   P0017 0.6726492
## P0014   P0014 0.6544079
## P0006   P0006 0.6283538
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== NODE BETWEENNESS DETAILED ANALYSIS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === NODE BETWEENNESS DETAILED ANALYSIS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Detailed betweenness analysis}
\NormalTok{betweenness\_stats }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(betweenness\_cent)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Betweenness centrality statistics:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Betweenness centrality statistics:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(betweenness\_stats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.00e+00 0.00e+00 0.00e+00 2.12e-05 3.66e-06 2.58e-03
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Nodes with highest betweenness (potential bridges):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Nodes with highest betweenness (potential bridges):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{high\_betweenness\_threshold }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(betweenness\_cent, }\FloatTok{0.95}\NormalTok{)}
\NormalTok{high\_betweenness\_nodes }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(betweenness\_cent }\SpecialCharTok{\textgreater{}=}\NormalTok{ high\_betweenness\_threshold)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of high betweenness nodes (top 5\%):"}\NormalTok{, }\FunctionTok{length}\NormalTok{(high\_betweenness\_nodes), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of high betweenness nodes (top 5%): 72
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create betweenness distribution plot}
\NormalTok{betweenness\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{node\_id =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name,}
  \AttributeTok{betweenness =}\NormalTok{ betweenness\_cent,}
  \AttributeTok{institution =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{institution,}
  \AttributeTok{subtopic =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{subtopic}
\NormalTok{)}

\CommentTok{\# Betweenness distribution histogram}
\FunctionTok{ggplot}\NormalTok{(betweenness\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ betweenness)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{30}\NormalTok{, }\AttributeTok{fill =} \StringTok{"purple"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Node Betweenness Centrality Distribution"}\NormalTok{,}
       \AttributeTok{subtitle =} \StringTok{"Distribution of bridging importance in largest component"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Normalized Betweenness Centrality"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/node-betweenness-analysis-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Identify top bridging papers}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Top 10 bridging papers (highest betweenness):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Top 10 bridging papers (highest betweenness):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_bridges }\OtherTok{\textless{}{-}}\NormalTok{ betweenness\_df[}\FunctionTok{order}\NormalTok{(betweenness\_df}\SpecialCharTok{$}\NormalTok{betweenness, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{], ]}
\FunctionTok{print}\NormalTok{(top\_bridges[, }\FunctionTok{c}\NormalTok{(}\StringTok{"node\_id"}\NormalTok{, }\StringTok{"betweenness"}\NormalTok{, }\StringTok{"subtopic"}\NormalTok{, }\StringTok{"institution"}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id  betweenness                                            subtopic
## P0011   P0011 0.0025803608                      Machine Learning in Healthcare
## P0060   P0060 0.0020943953 Artificial Intelligence in Healthcare and Education
## P0003   P0003 0.0019328651 Artificial Intelligence in Healthcare and Education
## P0002   P0002 0.0017329242 Artificial Intelligence in Healthcare and Education
## P0001   P0001 0.0013391788                      Machine Learning in Healthcare
## P0192   P0192 0.0009925863 Artificial Intelligence in Healthcare and Education
## P0484   P0484 0.0008632584 Artificial Intelligence in Healthcare and Education
## P0054   P0054 0.0008526921 Artificial Intelligence in Healthcare and Education
## P0136   P0136 0.0008494446 Artificial Intelligence in Healthcare and Education
## P0021   P0021 0.0006611386 Artificial Intelligence in Healthcare and Education
##                   institution
## P0011     Stanford University
## P0060 University Of Cambridge
## P0003         Yale University
## P0002      Harvard University
## P0001     Stanford University
## P0192  Mayo Clinic In Arizona
## P0484    Stanford Health Care
## P0054     Stanford University
## P0136     Stanford University
## P0021        Emory University
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== EDGE BETWEENNESS ANALYSIS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === EDGE BETWEENNESS ANALYSIS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate edge betweenness}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Calculating edge betweenness (this may take a moment)...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Calculating edge betweenness (this may take a moment)...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{edge\_betweenness }\OtherTok{\textless{}{-}} \FunctionTok{edge\_betweenness}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Edge betweenness calculation completed!}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Edge betweenness calculation completed!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of edges analyzed:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(edge\_betweenness), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of edges analyzed: 3634
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Edge betweenness statistics}
\NormalTok{edge\_bet\_stats }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(edge\_betweenness)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Edge betweenness statistics:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Edge betweenness statistics:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(edge\_bet\_stats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##    1.000    2.000    5.667   25.071   17.462 2536.235
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Find edges with highest betweenness}
\NormalTok{top\_edge\_indices }\OtherTok{\textless{}{-}} \FunctionTok{order}\NormalTok{(edge\_betweenness, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]}
\NormalTok{top\_edges }\OtherTok{\textless{}{-}} \FunctionTok{get.edges}\NormalTok{(largest\_component, top\_edge\_indices)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Top 10 edges by betweenness (most critical connections):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Top 10 edges by betweenness (most critical connections):
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{) \{}
\NormalTok{  edge\_idx }\OtherTok{\textless{}{-}}\NormalTok{ top\_edge\_indices[i]}
\NormalTok{  from\_node }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[top\_edges[i, }\DecValTok{1}\NormalTok{]]}
\NormalTok{  to\_node }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[top\_edges[i, }\DecValTok{2}\NormalTok{]]}
\NormalTok{  bet\_value }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(edge\_betweenness[edge\_idx], }\DecValTok{4}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%d. \%s {-}\textgreater{} \%s (betweenness: \%.4f)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, i, from\_node, to\_node, bet\_value))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 1. P0001 -> P0003 (betweenness: 2536.2345)
## 2. P0003 -> P0054 (betweenness: 2051.3298)
## 3. P0484 -> P0011 (betweenness: 1825.9821)
## 4. P0192 -> P0136 (betweenness: 1811.0000)
## 5. P0011 -> P0192 (betweenness: 1789.1667)
## 6. P0003 -> P0021 (betweenness: 1346.8333)
## 7. P0002 -> P0107 (betweenness: 1293.0250)
## 8. P0060 -> P0001 (betweenness: 1211.1667)
## 9. P0060 -> P0002 (betweenness: 1039.8810)
## 10. P0011 -> P0003 (betweenness: 1002.4452)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Edge betweenness distribution plot}
\NormalTok{edge\_bet\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{edge\_betweenness =}\NormalTok{ edge\_betweenness)}
\FunctionTok{ggplot}\NormalTok{(edge\_bet\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ edge\_betweenness)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{50}\NormalTok{, }\AttributeTok{fill =} \StringTok{"orange"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Edge Betweenness Distribution"}\NormalTok{,}
       \AttributeTok{subtitle =} \StringTok{"Distribution of edge importance as bridges in largest component"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Edge Betweenness"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/edge-betweenness-analysis-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== COMMUNITY DETECTION {-} METHOD 1: LOUVAIN ALGORITHM ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === COMMUNITY DETECTION - METHOD 1: LOUVAIN ALGORITHM ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Method 1: Louvain algorithm (modularity optimization)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Running Louvain algorithm for community detection...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Running Louvain algorithm for community detection...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Convert to undirected for community detection}
\NormalTok{largest\_component\_undirected }\OtherTok{\textless{}{-}} \FunctionTok{as.undirected}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"collapse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: `as.undirected()` was deprecated in igraph 2.1.0.
## i Please use `as_undirected()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Louvain algorithm}
\NormalTok{louvain\_communities }\OtherTok{\textless{}{-}} \FunctionTok{cluster\_louvain}\NormalTok{(largest\_component\_undirected)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Louvain algorithm completed!}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Louvain algorithm completed!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of communities found:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(louvain\_communities), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of communities found: 21
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Modularity score:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Modularity score: 0.576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Community size distribution}
\NormalTok{louvain\_sizes }\OtherTok{\textless{}{-}} \FunctionTok{sizes}\NormalTok{(louvain\_communities)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Community sizes:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Community sizes:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{sort}\NormalTok{(louvain\_sizes, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Community sizes
##   1   5   9   7   8   2   4  11  10  12   3   6  14  18  20  15  19  13  17  21 
## 219 137 137 129 121  99  93  88  66  48  46  44  41  38  38  34  19  15   9   8 
##  16 
##   4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Largest 5 communities:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Largest 5 communities:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{large\_communities }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(louvain\_sizes, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]}
\FunctionTok{print}\NormalTok{(large\_communities)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Community sizes
##   1   5   9   7   8 
## 219 137 137 129 121
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create community membership dataframe}
\NormalTok{louvain\_membership }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{node\_id =} \FunctionTok{V}\NormalTok{(largest\_component\_undirected)}\SpecialCharTok{$}\NormalTok{name,}
  \AttributeTok{community =} \FunctionTok{membership}\NormalTok{(louvain\_communities),}
  \AttributeTok{institution =} \FunctionTok{V}\NormalTok{(largest\_component\_undirected)}\SpecialCharTok{$}\NormalTok{institution,}
  \AttributeTok{subtopic =} \FunctionTok{V}\NormalTok{(largest\_component\_undirected)}\SpecialCharTok{$}\NormalTok{subtopic}
\NormalTok{)}

\CommentTok{\# Analyze community composition by subtopic}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Community composition analysis:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Community composition analysis:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(}\DecValTok{5}\NormalTok{, }\FunctionTok{length}\NormalTok{(louvain\_communities))) \{}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Community \%d (size: \%d):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, i, louvain\_sizes[i]))}
\NormalTok{  community\_nodes }\OtherTok{\textless{}{-}}\NormalTok{ louvain\_membership[louvain\_membership}\SpecialCharTok{$}\NormalTok{community }\SpecialCharTok{==}\NormalTok{ i, ]}
\NormalTok{  subtopic\_dist }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(community\_nodes}\SpecialCharTok{$}\NormalTok{subtopic)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Main subtopics:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{sort}\NormalTok{(subtopic\_dist, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(}\DecValTok{3}\NormalTok{, }\FunctionTok{length}\NormalTok{(subtopic\_dist))])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Community 1 (size: 219):
## Main subtopics:
## 
## Artificial Intelligence in Healthcare and Education 
##                                                 187 
##                      Machine Learning in Healthcare 
##                                                  25 
##               Artificial Intelligence in Healthcare 
##                                                   2 
## 
## Community 2 (size: 99):
## Main subtopics:
## 
## Artificial Intelligence in Healthcare and Education 
##                                                  82 
##                      Machine Learning in Healthcare 
##                                                  11 
##               Artificial Intelligence in Healthcare 
##                                                   3 
## 
## Community 3 (size: 46):
## Main subtopics:
## Machine Learning in Materials Science 
##                                    46 
## 
## Community 4 (size: 93):
## Main subtopics:
## 
## Artificial Intelligence in Healthcare and Education 
##                                                  82 
##                      Machine Learning in Healthcare 
##                                                   6 
##               Artificial Intelligence in Healthcare 
##                                                   4 
## 
## Community 5 (size: 137):
## Main subtopics:
## 
## Artificial Intelligence in Healthcare and Education 
##                                                 124 
##                      Machine Learning in Healthcare 
##                                                  12 
##            Machine Learning and Data Classification 
##                                                   1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== COMMUNITY DETECTION {-} METHOD 2: EDGE BETWEENNESS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === COMMUNITY DETECTION - METHOD 2: EDGE BETWEENNESS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Method 2: Edge betweenness{-}based community detection}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Running edge betweenness community detection...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Running edge betweenness community detection...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# This method removes edges with highest betweenness iteratively}
\NormalTok{edge\_betweenness\_communities }\OtherTok{\textless{}{-}} \FunctionTok{cluster\_edge\_betweenness}\NormalTok{(largest\_component\_undirected, }
                                                        \AttributeTok{directed =} \ConstantTok{FALSE}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Edge betweenness algorithm completed!}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Edge betweenness algorithm completed!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of communities found:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(edge\_betweenness\_communities), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of communities found: 65
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Modularity score:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(edge\_betweenness\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Modularity score: 0.5455
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Community size distribution}
\NormalTok{eb\_sizes }\OtherTok{\textless{}{-}} \FunctionTok{sizes}\NormalTok{(edge\_betweenness\_communities)}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Community sizes:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Community sizes:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{sort}\NormalTok{(eb\_sizes, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Community sizes
##   6   1   5  11   4  12   2  34   9   7  31  26  42  46  19  43   3  25  41   8 
## 282 238 150  50  46  35  32  31  27  26  24  22  21  21  20  19  15  15  15  14 
##  20  48  13  21  27  10  49  15  60  44  22  28  32  51  52  59  14  23  37  40 
##  14  14  13  13  13  12  12  11  11  10   9   9   9   9   9   9   8   8   8   8 
##  50  24  38  53  29  47  16  17  33  36  45  57  58  61  18  30  35  39  54  56 
##   8   7   7   7   6   6   5   5   5   5   5   5   5   5   4   4   4   4   4   4 
##  64  55  62  63  65 
##   4   3   3   3   3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compare the two methods}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== COMPARISON OF COMMUNITY DETECTION METHODS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === COMPARISON OF COMMUNITY DETECTION METHODS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Louvain {-} Communities:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(louvain\_communities), }
    \StringTok{"| Modularity:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Louvain - Communities: 21 | Modularity: 0.576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Edge Betweenness {-} Communities:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(edge\_betweenness\_communities), }
    \StringTok{"| Modularity:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(edge\_betweenness\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Edge Betweenness - Communities: 65 | Modularity: 0.5455
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create comparison plot}
\NormalTok{community\_comparison }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{Method =} \FunctionTok{c}\NormalTok{(}\StringTok{"Louvain"}\NormalTok{, }\StringTok{"Edge Betweenness"}\NormalTok{),}
  \AttributeTok{Communities =} \FunctionTok{c}\NormalTok{(}\FunctionTok{length}\NormalTok{(louvain\_communities), }\FunctionTok{length}\NormalTok{(edge\_betweenness\_communities)),}
  \AttributeTok{Modularity =} \FunctionTok{c}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\FunctionTok{modularity}\NormalTok{(edge\_betweenness\_communities))}
\NormalTok{)}

\CommentTok{\# Plot comparison}
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(community\_comparison, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Method, }\AttributeTok{y =}\NormalTok{ Communities, }\AttributeTok{fill =}\NormalTok{ Method)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Louvain"} \OtherTok{=} \StringTok{"lightblue"}\NormalTok{, }
                               \StringTok{"Edge Betweenness"} \OtherTok{=} \StringTok{"lightcoral"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Number of Communities"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Number of Communities"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(community\_comparison, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Method, }\AttributeTok{y =}\NormalTok{ Modularity, }\AttributeTok{fill =}\NormalTok{ Method)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Louvain"} \OtherTok{=} \StringTok{"lightblue"}\NormalTok{, }
                               \StringTok{"Edge Betweenness"} \OtherTok{=} \StringTok{"lightcoral"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Modularity Score"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Modularity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\CommentTok{\# Display plots side by side}
\FunctionTok{grid.arrange}\NormalTok{(p1, p2, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }
             \AttributeTok{top =} \StringTok{"Community Detection Methods Comparison"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/community-detection-method2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== CENTRALITY MEASURES CORRELATION ANALYSIS ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === CENTRALITY MEASURES CORRELATION ANALYSIS ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Analyze correlations between different centrality measures}
\NormalTok{centrality\_cor\_data }\OtherTok{\textless{}{-}}\NormalTok{ centrality\_summary[, }
                              \FunctionTok{c}\NormalTok{(}\StringTok{"degree\_in"}\NormalTok{, }\StringTok{"degree\_out"}\NormalTok{, }\StringTok{"betweenness"}\NormalTok{, }
                                \StringTok{"closeness\_in"}\NormalTok{, }\StringTok{"closeness\_out"}\NormalTok{, }
                                \StringTok{"eigenvector"}\NormalTok{, }\StringTok{"pagerank"}\NormalTok{, }\StringTok{"authority"}\NormalTok{, }\StringTok{"hub"}\NormalTok{)]}

\CommentTok{\# Calculate correlation matrix}
\NormalTok{cor\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(centrality\_cor\_data, }\AttributeTok{use =} \StringTok{"complete.obs"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in cor(centrality_cor_data, use = "complete.obs"): 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Correlation matrix calculated}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Correlation matrix calculated
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{round}\NormalTok{(cor\_matrix, }\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               degree_in degree_out betweenness closeness_in closeness_out
## degree_in         1.000      0.002       0.616       -0.390         0.138
## degree_out        0.002      1.000       0.173        0.152        -0.262
## betweenness       0.616      0.173       1.000       -0.260        -0.101
## closeness_in     -0.390      0.152      -0.260        1.000        -0.277
## closeness_out     0.138     -0.262      -0.101       -0.277         1.000
## eigenvector          NA         NA          NA           NA            NA
## pagerank          0.696     -0.057       0.460       -0.356         0.162
## authority         0.869      0.029       0.435       -0.311         0.125
## hub               0.096      0.670       0.110        0.036        -0.170
##               eigenvector pagerank authority    hub
## degree_in              NA    0.696     0.869  0.096
## degree_out             NA   -0.057     0.029  0.670
## betweenness            NA    0.460     0.435  0.110
## closeness_in           NA   -0.356    -0.311  0.036
## closeness_out          NA    0.162     0.125 -0.170
## eigenvector             1       NA        NA     NA
## pagerank               NA    1.000     0.498 -0.012
## authority              NA    0.498     1.000  0.187
## hub                    NA   -0.012     0.187  1.000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create correlation heatmap}
\NormalTok{cor\_melted }\OtherTok{\textless{}{-}} \FunctionTok{melt}\NormalTok{(cor\_matrix)}
\FunctionTok{ggplot}\NormalTok{(cor\_melted, }\FunctionTok{aes}\NormalTok{(Var1, Var2, }\AttributeTok{fill =}\NormalTok{ value)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_gradient2}\NormalTok{(}\AttributeTok{low =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{high =} \StringTok{"red"}\NormalTok{, }\AttributeTok{mid =} \StringTok{"white"}\NormalTok{, }
                      \AttributeTok{midpoint =} \DecValTok{0}\NormalTok{, }\AttributeTok{limit =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{space =} \StringTok{"Lab"}\NormalTok{,}
                      \AttributeTok{name=}\StringTok{"Correlation"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{vjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Centrality Measures Correlation Matrix"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{""}\NormalTok{, }\AttributeTok{y =} \StringTok{""}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(value, }\DecValTok{2}\NormalTok{)), }\AttributeTok{size =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 16 rows containing missing values or values outside the scale range
## (`geom_text()`).
\end{verbatim}

\includegraphics{Deeper-analysis_files/figure-latex/centrality-correlation-analysis-1.pdf}

\subsection{Largest Component Visualization (Jinxi
Hu)}\label{largest-component-visualization-jinxi-hu}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"=== LARGEST COMPONENT VISUALIZATION ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## === LARGEST COMPONENT VISUALIZATION ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Basic layout for consistent visualization across all plots}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Calculating network layout (this may take a moment)...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Calculating network layout (this may take a moment)...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{layout\_large }\OtherTok{\textless{}{-}} \FunctionTok{layout\_with\_fr}\NormalTok{(largest\_component, }
                              \AttributeTok{weights =} \ConstantTok{NULL}\NormalTok{, }
                              \AttributeTok{niter =} \DecValTok{1000}\NormalTok{, }
                              \AttributeTok{start.temp =} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{vcount}\NormalTok{(largest\_component)))}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Layout calculation completed!}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Layout calculation completed!
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Plotting largest component with different color schemes...}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Plotting largest component with different color schemes...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Basic plot with default colors}
\FunctionTok{plot}\NormalTok{(largest\_component, }
     \AttributeTok{layout =}\NormalTok{ layout\_large,}
     \AttributeTok{vertex.size =} \DecValTok{4}\NormalTok{, }
     \AttributeTok{vertex.label =} \ConstantTok{NA}\NormalTok{,}
     \AttributeTok{edge.arrow.size =} \FloatTok{0.3}\NormalTok{,}
     \AttributeTok{edge.width =} \FloatTok{0.5}\NormalTok{,}
     \AttributeTok{edge.color =} \StringTok{"gray70"}\NormalTok{,}
     \AttributeTok{vertex.color =} \StringTok{"lightblue"}\NormalTok{,}
     \AttributeTok{vertex.frame.color =} \StringTok{"white"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Largest Component {-} Basic View"}\NormalTok{,}
     \AttributeTok{sub =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }
                \StringTok{"| Edges:"}\NormalTok{, }\FunctionTok{ecount}\NormalTok{(largest\_component)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/largest-component-basic-plot-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot colored by research subtopic}
\FunctionTok{cat}\NormalTok{(}\StringTok{"1. VISUALIZATION BY RESEARCH SUBTOPIC}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 1. VISUALIZATION BY RESEARCH SUBTOPIC
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get unique subtopics and create color palette}
\NormalTok{subtopics\_large }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{subtopic}
\NormalTok{unique\_subtopics }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(subtopics\_large)}
\NormalTok{n\_subtopics }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(unique\_subtopics)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of unique subtopics in largest component:"}\NormalTok{, n\_subtopics, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of unique subtopics in largest component: 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create color palette for subtopics}
\ControlFlowTok{if}\NormalTok{(n\_subtopics }\SpecialCharTok{\textless{}=} \DecValTok{12}\NormalTok{) \{}
\NormalTok{  colors\_subtopic }\OtherTok{\textless{}{-}}\NormalTok{ RColorBrewer}\SpecialCharTok{::}\FunctionTok{brewer.pal}\NormalTok{(}\FunctionTok{max}\NormalTok{(}\DecValTok{3}\NormalTok{, n\_subtopics), }\StringTok{"Set3"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \CommentTok{\# For more than 12 subtopics, use rainbow colors}
\NormalTok{  colors\_subtopic }\OtherTok{\textless{}{-}} \FunctionTok{rainbow}\NormalTok{(n\_subtopics)}
\NormalTok{\}}

\CommentTok{\# Create named color vector to ensure consistent mapping}
\FunctionTok{names}\NormalTok{(colors\_subtopic) }\OtherTok{\textless{}{-}}\NormalTok{ unique\_subtopics}

\CommentTok{\# Assign colors to nodes using the named vector}
\NormalTok{vertex\_colors\_subtopic }\OtherTok{\textless{}{-}}\NormalTok{ colors\_subtopic[subtopics\_large]}

\CommentTok{\# Plot by subtopic}
\FunctionTok{plot}\NormalTok{(largest\_component, }
     \AttributeTok{layout =}\NormalTok{ layout\_large,}
     \AttributeTok{vertex.size =} \DecValTok{4}\NormalTok{, }
     \AttributeTok{vertex.label =} \ConstantTok{NA}\NormalTok{,}
     \AttributeTok{edge.arrow.size =} \FloatTok{0.3}\NormalTok{,}
     \AttributeTok{edge.width =} \FloatTok{0.5}\NormalTok{,}
     \AttributeTok{edge.color =} \StringTok{"gray70"}\NormalTok{,}
     \AttributeTok{vertex.color =}\NormalTok{ vertex\_colors\_subtopic,}
     \AttributeTok{vertex.frame.color =} \StringTok{"white"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Largest Component {-} Colored by Research Subtopic"}\NormalTok{,}
     \AttributeTok{sub =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }
                \StringTok{"| Subtopics:"}\NormalTok{, n\_subtopics))}

\CommentTok{\# Add legend for subtopics (show top 10 only if too many)}
\ControlFlowTok{if}\NormalTok{(n\_subtopics }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{) \{}
  \CommentTok{\# Show only the most frequent subtopics}
\NormalTok{  top\_subtopics }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(}\FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(subtopics\_large), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{))[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]}
\NormalTok{  legend\_subtopics }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(top\_subtopics, }\StringTok{"Others..."}\NormalTok{)}
\NormalTok{  legend\_colors }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(colors\_subtopic[top\_subtopics], }\StringTok{"gray"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  legend\_subtopics }\OtherTok{\textless{}{-}}\NormalTok{ unique\_subtopics}
\NormalTok{  legend\_colors }\OtherTok{\textless{}{-}}\NormalTok{ colors\_subtopic[unique\_subtopics]}
\NormalTok{\}}

\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \AttributeTok{legend =}\NormalTok{ legend\_subtopics,}
       \AttributeTok{fill =}\NormalTok{ legend\_colors,}
       \AttributeTok{cex =} \FloatTok{0.6}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Research Subtopic"}\NormalTok{,}
       \AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/largest-component-by-subtopic-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print subtopic distribution}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Subtopic distribution in largest component:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Subtopic distribution in largest component:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subtopic\_dist }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(subtopics\_large), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{head}\NormalTok{(subtopic\_dist, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## subtopics_large
## Artificial Intelligence in Healthcare and Education 
##                                                1171 
##                      Machine Learning in Healthcare 
##                                                 153 
##               Machine Learning in Materials Science 
##                                                  49 
##              Natural Language Processing Techniques 
##                                                  21 
##               Artificial Intelligence in Healthcare 
##                                                  17 
##                      Artificial Intelligence in Law 
##                                                  16 
##                  Machine Learning in Bioinformatics 
##                                                   3 
##            Machine Learning and Data Classification 
##                                                   2 
##                    Artificial Intelligence in Games 
##                                                   1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot colored by institution}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{2. VISUALIZATION BY INSTITUTION}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 2. VISUALIZATION BY INSTITUTION
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get unique institutions and create color palette}
\NormalTok{institutions\_large }\OtherTok{\textless{}{-}} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{institution}
\NormalTok{unique\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(institutions\_large)}
\NormalTok{n\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(unique\_institutions)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of unique institutions in largest component:"}\NormalTok{, n\_institutions, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of unique institutions in largest component: 508
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get top 10 institutions by frequency first}
\NormalTok{institution\_counts }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(institutions\_large), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{(n\_institutions }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{) \{}
\NormalTok{  top\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(institution\_counts)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  top\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(institution\_counts)}
\NormalTok{\}}

\CommentTok{\# Create color palette for institutions with better differentiation}
\ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(top\_institutions) }\SpecialCharTok{\textless{}=} \DecValTok{12}\NormalTok{) \{}
  \CommentTok{\# Use highly contrasting colors with maximum visual separation}
\NormalTok{  colors\_for\_top }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"\#FF0000"}\NormalTok{, }\StringTok{"\#0000FF"}\NormalTok{, }\StringTok{"\#00AA00"}\NormalTok{, }\StringTok{"\#FF8000"}\NormalTok{, }\StringTok{"\#8000FF"}\NormalTok{, }
                     \StringTok{"\#00CCCC"}\NormalTok{, }\StringTok{"\#FF1493"}\NormalTok{, }\StringTok{"\#32CD32"}\NormalTok{, }\StringTok{"\#FFD700"}\NormalTok{, }\StringTok{"\#8B4513"}\NormalTok{, }
                     \StringTok{"\#FF69B4"}\NormalTok{, }\StringTok{"\#4169E1"}\NormalTok{)}
\NormalTok{  colors\_top\_institutions }\OtherTok{\textless{}{-}}\NormalTok{ colors\_for\_top[}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(top\_institutions)]}
  \FunctionTok{names}\NormalTok{(colors\_top\_institutions) }\OtherTok{\textless{}{-}}\NormalTok{ top\_institutions}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \CommentTok{\# For more than 12 institutions, use diverse colors with better spacing}
\NormalTok{  colors\_top\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{rainbow}\NormalTok{(}\FunctionTok{length}\NormalTok{(top\_institutions), }\AttributeTok{s =} \DecValTok{1}\NormalTok{, }\AttributeTok{v =} \FloatTok{0.8}\NormalTok{)}
  \FunctionTok{names}\NormalTok{(colors\_top\_institutions) }\OtherTok{\textless{}{-}}\NormalTok{ top\_institutions}
\NormalTok{\}}

\CommentTok{\# Assign colors to nodes}
\NormalTok{vertex\_colors\_display }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\StringTok{"gray"}\NormalTok{, }\FunctionTok{length}\NormalTok{(institutions\_large))}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(institutions\_large)) \{}
  \ControlFlowTok{if}\NormalTok{(institutions\_large[i] }\SpecialCharTok{\%in\%}\NormalTok{ top\_institutions) \{}
\NormalTok{    vertex\_colors\_display[i] }\OtherTok{\textless{}{-}}\NormalTok{ colors\_top\_institutions[institutions\_large[i]]}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# Plot by institution}
\FunctionTok{plot}\NormalTok{(largest\_component, }
     \AttributeTok{layout =}\NormalTok{ layout\_large,}
     \AttributeTok{vertex.size =} \DecValTok{4}\NormalTok{, }
     \AttributeTok{vertex.label =} \ConstantTok{NA}\NormalTok{,}
     \AttributeTok{edge.arrow.size =} \FloatTok{0.3}\NormalTok{,}
     \AttributeTok{edge.width =} \FloatTok{0.5}\NormalTok{,}
     \AttributeTok{edge.color =} \StringTok{"gray70"}\NormalTok{,}
     \AttributeTok{vertex.color =}\NormalTok{ vertex\_colors\_display,}
     \AttributeTok{vertex.frame.color =} \StringTok{"white"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Largest Component {-} Colored by Institution"}\NormalTok{,}
     \AttributeTok{sub =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }
                \StringTok{"| Institutions:"}\NormalTok{, n\_institutions))}

\CommentTok{\# Add legend for institutions}
\ControlFlowTok{if}\NormalTok{(n\_institutions }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{) \{}
\NormalTok{  legend\_institutions }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(top\_institutions, }\StringTok{"Others..."}\NormalTok{)}
\NormalTok{  legend\_colors\_inst }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(colors\_top\_institutions[top\_institutions], }\StringTok{"gray"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  legend\_institutions }\OtherTok{\textless{}{-}}\NormalTok{ top\_institutions}
\NormalTok{  legend\_colors\_inst }\OtherTok{\textless{}{-}}\NormalTok{ colors\_top\_institutions[top\_institutions]}
\NormalTok{\}}

\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \AttributeTok{legend =}\NormalTok{ legend\_institutions,}
       \AttributeTok{fill =}\NormalTok{ legend\_colors\_inst,}
       \AttributeTok{cex =} \FloatTok{0.6}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Institution"}\NormalTok{,}
       \AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/largest-component-by-institution-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print institution distribution}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Institution distribution in largest component:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Institution distribution in largest component:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{institution\_dist }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(}\FunctionTok{table}\NormalTok{(institutions\_large), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{head}\NormalTok{(institution\_dist, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## institutions_large
##                   Stanford University                    Harvard University 
##                                   115                                    88 
##               Imperial College London                  University Of Oxford 
##                                    63                                    59 
##               University Of Cambridge Massachusetts Institute Of Technology 
##                                    48                                    38 
##      National University Of Singapore             University College London 
##                                    33                                    25 
##          Brigham And Women'S Hospital  Beth Israel Deaconess Medical Center 
##                                    24                                    19
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot colored by Louvain communities}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{3. VISUALIZATION BY LOUVAIN COMMUNITIES}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 3. VISUALIZATION BY LOUVAIN COMMUNITIES
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get community membership (already calculated in previous chunk)}
\NormalTok{community\_membership }\OtherTok{\textless{}{-}} \FunctionTok{membership}\NormalTok{(louvain\_communities)}
\NormalTok{n\_communities }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(louvain\_communities)}

\FunctionTok{cat}\NormalTok{(}\StringTok{"Number of Louvain communities:"}\NormalTok{, n\_communities, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Number of Louvain communities: 21
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Modularity score:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Modularity score: 0.576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create color palette for communities}
\ControlFlowTok{if}\NormalTok{(n\_communities }\SpecialCharTok{\textless{}=} \DecValTok{12}\NormalTok{) \{}
\NormalTok{  colors\_community }\OtherTok{\textless{}{-}}\NormalTok{ RColorBrewer}\SpecialCharTok{::}\FunctionTok{brewer.pal}\NormalTok{(}\FunctionTok{max}\NormalTok{(}\DecValTok{3}\NormalTok{, n\_communities), }\StringTok{"Set1"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  colors\_community }\OtherTok{\textless{}{-}} \FunctionTok{rainbow}\NormalTok{(n\_communities)}
\NormalTok{\}}

\CommentTok{\# Assign colors to nodes based on community membership}
\NormalTok{vertex\_colors\_community }\OtherTok{\textless{}{-}}\NormalTok{ colors\_community[community\_membership]}

\CommentTok{\# Plot by community}
\FunctionTok{plot}\NormalTok{(largest\_component\_undirected,  }\CommentTok{\# Use undirected version for community plot}
     \AttributeTok{layout =}\NormalTok{ layout\_large,}
     \AttributeTok{vertex.size =} \DecValTok{4}\NormalTok{, }
     \AttributeTok{vertex.label =} \ConstantTok{NA}\NormalTok{,}
     \AttributeTok{edge.width =} \FloatTok{0.5}\NormalTok{,}
     \AttributeTok{edge.color =} \StringTok{"gray70"}\NormalTok{,}
     \AttributeTok{vertex.color =}\NormalTok{ vertex\_colors\_community,}
     \AttributeTok{vertex.frame.color =} \StringTok{"white"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Largest Component {-} Colored by Louvain Communities"}\NormalTok{,}
     \AttributeTok{sub =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }
                \StringTok{"| Communities:"}\NormalTok{, n\_communities, }
                \StringTok{"| Modularity:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\DecValTok{3}\NormalTok{)))}

\CommentTok{\# Add legend for communities}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \AttributeTok{legend =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Community"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(n\_communities, }\DecValTok{10}\NormalTok{)),}
       \AttributeTok{fill =}\NormalTok{ colors\_community[}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(n\_communities, }\DecValTok{10}\NormalTok{)],}
       \AttributeTok{cex =} \FloatTok{0.6}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Louvain Community"}\NormalTok{,}
       \AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/largest-component-by-community-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print community size distribution}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Community size distribution:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Community size distribution:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{community\_sizes }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(}\FunctionTok{sizes}\NormalTok{(louvain\_communities), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(community\_sizes)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Community sizes
##   1   5   9   7   8   2   4  11  10  12   3   6  14  18  20  15  19  13  17  21 
## 219 137 137 129 121  99  93  88  66  48  46  44  41  38  38  34  19  15   9   8 
##  16 
##   4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot with node sizes representing centrality measures}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{4. VISUALIZATION WITH CENTRALITY{-}WEIGHTED NODE SIZES}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 4. VISUALIZATION WITH CENTRALITY-WEIGHTED NODE SIZES
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Use PageRank centrality for node sizes}
\NormalTok{pagerank\_values }\OtherTok{\textless{}{-}} \FunctionTok{page\_rank}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{$}\NormalTok{vector}
\CommentTok{\# Scale node sizes appropriately (between 2 and 15)}
\NormalTok{node\_sizes }\OtherTok{\textless{}{-}} \DecValTok{2} \SpecialCharTok{+} \DecValTok{13} \SpecialCharTok{*}\NormalTok{ (pagerank\_values }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(pagerank\_values)) }\SpecialCharTok{/} 
\NormalTok{              (}\FunctionTok{max}\NormalTok{(pagerank\_values) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(pagerank\_values))}

\CommentTok{\# Plot with PageRank{-}weighted sizes and community colors}
\FunctionTok{plot}\NormalTok{(largest\_component, }
     \AttributeTok{layout =}\NormalTok{ layout\_large,}
     \AttributeTok{vertex.size =}\NormalTok{ node\_sizes, }
     \AttributeTok{vertex.label =} \ConstantTok{NA}\NormalTok{,}
     \AttributeTok{edge.arrow.size =} \FloatTok{0.3}\NormalTok{,}
     \AttributeTok{edge.width =} \FloatTok{0.5}\NormalTok{,}
     \AttributeTok{edge.color =} \StringTok{"gray70"}\NormalTok{,}
     \AttributeTok{vertex.color =}\NormalTok{ vertex\_colors\_community,}
     \AttributeTok{vertex.frame.color =} \StringTok{"white"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Largest Component {-} Communities with PageRank{-}weighted Sizes"}\NormalTok{,}
     \AttributeTok{sub =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Node size  PageRank centrality | Communities by Louvain algorithm"}\NormalTok{))}

\CommentTok{\# Add legends}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }
       \AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"Smallest PageRank"}\NormalTok{, }\StringTok{"Largest PageRank"}\NormalTok{),}
       \AttributeTok{pch =} \DecValTok{21}\NormalTok{,}
       \AttributeTok{pt.cex =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\DecValTok{2}\NormalTok{),}
       \AttributeTok{pt.bg =} \StringTok{"lightblue"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Node Size"}\NormalTok{,}
       \AttributeTok{bg =} \StringTok{"white"}\NormalTok{,}
       \AttributeTok{cex =} \FloatTok{0.8}\NormalTok{)}

\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \AttributeTok{legend =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Community"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(n\_communities, }\DecValTok{8}\NormalTok{)),}
       \AttributeTok{fill =}\NormalTok{ colors\_community[}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{min}\NormalTok{(n\_communities, }\DecValTok{8}\NormalTok{)],}
       \AttributeTok{cex =} \FloatTok{0.6}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"Louvain Community"}\NormalTok{,}
       \AttributeTok{bg =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Deeper-analysis_files/figure-latex/largest-component-weighted-by-centrality-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print top PageRank nodes}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Top 10 nodes by PageRank centrality:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Top 10 nodes by PageRank centrality:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_pagerank\_nodes }\OtherTok{\textless{}{-}} \FunctionTok{order}\NormalTok{(pagerank\_values, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{]}
\NormalTok{pagerank\_summary }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{node\_id =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[top\_pagerank\_nodes],}
  \AttributeTok{pagerank =} \FunctionTok{round}\NormalTok{(pagerank\_values[top\_pagerank\_nodes], }\DecValTok{4}\NormalTok{),}
  \AttributeTok{community =}\NormalTok{ community\_membership[top\_pagerank\_nodes],}
  \AttributeTok{subtopic =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{subtopic[top\_pagerank\_nodes],}
  \AttributeTok{institution =} \FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{institution[top\_pagerank\_nodes]}
\NormalTok{)}
\FunctionTok{print}\NormalTok{(pagerank\_summary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       node_id pagerank community
## P0199   P0199   0.0405         7
## P0031   P0031   0.0323         5
## P0741   P0741   0.0197         7
## P0116   P0116   0.0175         7
## P0535   P0535   0.0157        11
## P0012   P0012   0.0138         7
## P0060   P0060   0.0125         1
## P0002   P0002   0.0114         2
## P0015   P0015   0.0110         4
## P1179   P1179   0.0104        11
##                                                  subtopic
## P0199 Artificial Intelligence in Healthcare and Education
## P0031 Artificial Intelligence in Healthcare and Education
## P0741 Artificial Intelligence in Healthcare and Education
## P0116 Artificial Intelligence in Healthcare and Education
## P0535 Artificial Intelligence in Healthcare and Education
## P0012                      Machine Learning in Healthcare
## P0060 Artificial Intelligence in Healthcare and Education
## P0002 Artificial Intelligence in Healthcare and Education
## P0015 Artificial Intelligence in Healthcare and Education
## P1179               Artificial Intelligence in Healthcare
##                            institution
## P0199               Harvard University
## P0031          Imperial College London
## P0741               Harvard University
## P0116              Stanford University
## P0535           University Of Michigan
## P0012               Harvard University
## P0060          University Of Cambridge
## P0002               Harvard University
## P0015 National University Of Singapore
## P1179 National University Of Singapore
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== LARGEST COMPONENT ANALYSIS SUMMARY ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## === LARGEST COMPONENT ANALYSIS SUMMARY ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Summary statistics}
\FunctionTok{cat}\NormalTok{(}\StringTok{"STRUCTURAL PROPERTIES:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## STRUCTURAL PROPERTIES:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Nodes:"}\NormalTok{, }\FunctionTok{vcount}\NormalTok{(largest\_component), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Nodes: 1433
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Edges:"}\NormalTok{, }\FunctionTok{ecount}\NormalTok{(largest\_component), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Edges: 3634
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Density:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{edge\_density}\NormalTok{(largest\_component), }\DecValTok{6}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Density: 0.001771
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Average clustering coefficient:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{transitivity}\NormalTok{(largest\_component, }\AttributeTok{type =} \StringTok{"average"}\NormalTok{), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Average clustering coefficient: 0.1433
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Diameter:"}\NormalTok{, }\FunctionTok{diameter}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{FALSE}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Diameter: 13
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Average path length:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{mean\_distance}\NormalTok{(largest\_component, }\AttributeTok{directed =} \ConstantTok{FALSE}\NormalTok{), }\DecValTok{2}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Average path length: 4.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"DIVERSITY MEASURES:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## DIVERSITY MEASURES:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Research subtopics:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(subtopics\_large)), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Research subtopics: 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Institutions:"}\NormalTok{, }\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(institutions\_large)), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Institutions: 508
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Louvain communities:"}\NormalTok{, n\_communities, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Louvain communities: 21
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Community modularity:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{modularity}\NormalTok{(louvain\_communities), }\DecValTok{4}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Community modularity: 0.576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"CENTRALITY HIGHLIGHTS:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## CENTRALITY HIGHLIGHTS:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Highest PageRank node:"}\NormalTok{, }\FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[}\FunctionTok{which.max}\NormalTok{(pagerank\_values)], }
    \StringTok{"("}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(pagerank\_values), }\DecValTok{4}\NormalTok{), }\StringTok{")}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Highest PageRank node: P0199 ( 0.0405 )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Highest betweenness node:"}\NormalTok{, }\FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[}\FunctionTok{which.max}\NormalTok{(betweenness\_cent)], }
    \StringTok{"("}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(betweenness\_cent), }\DecValTok{4}\NormalTok{), }\StringTok{")}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Highest betweenness node: P0011 ( 0.0026 )
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"{-} Most cited node (in{-}degree):"}\NormalTok{, }\FunctionTok{V}\NormalTok{(largest\_component)}\SpecialCharTok{$}\NormalTok{name[}\FunctionTok{which.max}\NormalTok{(degree\_cent\_in)], }
    \StringTok{"("}\NormalTok{, }\FunctionTok{max}\NormalTok{(}\FunctionTok{degree}\NormalTok{(largest\_component, }\AttributeTok{mode =} \StringTok{"in"}\NormalTok{)), }\StringTok{" citations)}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## - Most cited node (in-degree): P0060 ( 104  citations)
\end{verbatim}

\end{document}
